<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asset Tracker (Cloud Sync)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import { createRoot } from 'react-dom/client';
        import { Camera, Plus, Save, Wrench, Clock, FileText, ChevronLeft, Search, Trash2, MapPin, Tag, ShoppingBag, DollarSign, X, LayoutDashboard, List, BarChart3, AlertTriangle, TrendingUp, Calendar, Folder, Image as ImageIcon, Building2, PlusCircle, Package, File as FileIcon, UploadCloud, Loader2, Settings, Lock, Check, RefreshCw, DownloadCloud } from 'lucide-react';

        // --- CONSTANTS ---
        const DEFAULT_CONFIG = {
            scriptUrl: 'https://script.google.com/macros/s/AKfycbxrg3L1Kvzbjh5U0WlFve8ExsGYcC8YTte2qB8Rs5Ckkza4aDjQ4QRFpCtz599s1NdE/exec',
            adminPassword: '888'
        };

        // --- Helper Functions ---
        const fileToBase64 = (file) => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        const generateCode = () => `EQ-${new Date().getFullYear()}-${Math.floor(Math.random() * 10000).toString().padStart(4, '0')}`;

        const calculateAge = (dateString) => {
            if (!dateString) return '-';
            const start = new Date(dateString);
            const end = new Date();
            let years = end.getFullYear() - start.getFullYear();
            let months = end.getMonth() - start.getMonth();
            if (months < 0) { years--; months += 12; }
            if (years < 0) return "ยังไม่ถึงวันใช้งาน";
            return years > 0 ? `${years} ปี ${months > 0 ? months + ' เดือน' : ''}` : (months > 0 ? `${months} เดือน` : 'เพิ่งซื้อ');
        };

        function App() {
            // State
            const [view, setView] = useState('dashboard');
            const [config, setConfig] = useState(() => {
                const saved = localStorage.getItem('assetTrackerConfig');
                return saved ? JSON.parse(saved) : DEFAULT_CONFIG;
            });
            
            // App Data
            const [items, setItems] = useState([]); // เริ่มต้นว่างเปล่า รอโหลดจาก Google
            const [departmentList, setDepartmentList] = useState([]);
            const [selectedItem, setSelectedItem] = useState(null);
            const [selectedDepartment, setSelectedDepartment] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            
            // Status State
            const [isLoading, setIsLoading] = useState(false);
            const [isSyncing, setIsSyncing] = useState(false);
            const [showAdminModal, setShowAdminModal] = useState(false);
            const [adminInputPassword, setAdminInputPassword] = useState('');
            const [tempConfig, setTempConfig] = useState(config);

            // --- Load Data on Start ---
            useEffect(() => {
                fetchFromGoogle();
            }, []);

            // --- Google API Logic ---
            const fetchFromGoogle = async () => {
                if (!config.scriptUrl) return;
                setIsLoading(true);
                try {
                    const response = await fetch(config.scriptUrl);
                    const data = await response.json();
                    
                    if (Array.isArray(data)) {
                        setItems(data);
                        // Update department list form data
                        const depts = [...new Set(data.map(i => i.location).filter(Boolean))];
                        setDepartmentList(depts);
                    } else if (data.error) {
                        alert("เกิดข้อผิดพลาดจาก Server: " + data.error);
                    }
                } catch (error) {
                    console.error("Fetch Error:", error);
                    alert("ไม่สามารถดึงข้อมูลจาก Google Sheet ได้ (ตรวจสอบ URL หรือ Internet)");
                } finally {
                    setIsLoading(false);
                }
            };

            const syncToGoogle = async (itemData) => {
                if (!config.scriptUrl) return alert("กรุณาตั้งค่า URL ก่อน");
                setIsSyncing(true);
                try {
                    await fetch(config.scriptUrl, {
                        method: 'POST',
                        mode: 'no-cors', 
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(itemData)
                    });
                    // เนื่องจาก no-cors เราไม่รู้ผลลัพธ์ที่แน่ชัด แต่ถ้าไม่ error ถือว่าส่งไปแล้ว
                    // ให้หน่วงเวลาแล้วดึงข้อมูลใหม่
                    setTimeout(() => {
                        fetchFromGoogle(); // Refresh data to confirm save
                        alert("บันทึกข้อมูลและ Sync เรียบร้อยแล้ว");
                    }, 2000); 
                } catch (error) {
                    alert("Sync ล้มเหลว: " + error.message);
                } finally {
                    setIsSyncing(false);
                }
            };

            // --- Local Actions ---
            const handleAddItem = (newItem) => {
                // Optimistic UI Update (เพิ่มในหน้าจอก่อน แล้วค่อยส่ง)
                setItems(prev => [newItem, ...prev]);
                if (newItem.location && !departmentList.includes(newItem.location)) {
                    setDepartmentList(prev => [...prev, newItem.location]);
                }
                syncToGoogle(newItem); // Auto Sync
                setSelectedDepartment(newItem.location);
                setView('departmentItems');
            };

            const handleUpdateItem = (updatedItem) => {
                setItems(prev => prev.map(item => item.id === updatedItem.id ? updatedItem : item));
                setSelectedItem(updatedItem);
                syncToGoogle(updatedItem); // Auto Sync
            };

            const deleteItem = (id) => {
                if(confirm('การลบในหน้านี้อาจไม่ลบใน Google Sheet ทันที (ต้องลบใน Sheet เองเพื่อความปลอดภัย) ต้องการซ่อนจากหน้านี้หรือไม่?')) {
                    setItems(prev => prev.filter(i => i.id !== id));
                    setView('departmentItems');
                }
            };

            // --- Sub-Components ---
            const LoadingOverlay = () => (
                <div className="fixed inset-0 bg-white/80 z-50 flex flex-col items-center justify-center backdrop-blur-sm">
                    <Loader2 className="animate-spin text-blue-600 mb-2" size={48} />
                    <p className="text-slate-600 font-medium">กำลังเชื่อมต่อฐานข้อมูล Google...</p>
                </div>
            );

            // ... (View Components: DashboardView, DepartmentListView etc. - Same logic, slightly adapted) ...
            
            const DashboardView = () => {
                const totalAssets = items.length;
                const totalRepairs = items.reduce((sum, item) => sum + (item.history?.filter(h => h.type === 'repair').length || 0), 0);
                return (
                    <div className="space-y-6 fade-in pb-10">
                        <div className="bg-blue-600 text-white p-6 rounded-2xl shadow-lg flex justify-between items-center">
                             <div>
                                <h2 className="text-2xl font-bold mb-1">ยินดีต้อนรับ</h2>
                                <p className="text-blue-100 text-sm">ระบบเชื่อมต่อกับ Google Sheet เรียบร้อยแล้ว</p>
                             </div>
                             <div className="bg-white/20 p-3 rounded-lg"><DownloadCloud size={32}/></div>
                        </div>
                        <div className="grid grid-cols-2 gap-4">
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                                <div className="text-sm text-slate-500 mb-1">อุปกรณ์ทั้งหมด</div>
                                <div className="text-3xl font-bold text-slate-800">{totalAssets}</div>
                            </div>
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                                <div className="text-sm text-slate-500 mb-1">รายการซ่อมบำรุง</div>
                                <div className="text-3xl font-bold text-orange-600">{totalRepairs}</div>
                            </div>
                        </div>
                    </div>
                );
            };

            // (ส่วน DepartmentListView, DepartmentItemsView ใช้ Logic เดิม แต่ดึงตัวแปร items จาก State หลัก)
            const DepartmentListView = () => {
                // คำนวณจำนวนจาก items ล่าสุดเสมอ
                const counts = items.reduce((acc, i) => { 
                    acc[i.location] = (acc[i.location] || 0) + 1; 
                    return acc; 
                }, {});
                
                return (
                    <div className="fade-in pb-10">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-xl font-bold text-slate-800">แผนก ({departmentList.length})</h2>
                            <div className="flex gap-2">
                                <button onClick={() => { 
                                    const n = prompt("ชื่อแผนกใหม่:"); 
                                    if(n) setDepartmentList([...departmentList, n]); 
                                }} className="bg-white border px-3 py-2 rounded-lg text-sm flex items-center gap-1 shadow-sm"><PlusCircle size={16}/> แผนก</button>
                                <button onClick={() => setView('add')} className="bg-blue-600 text-white px-3 py-2 rounded-lg text-sm flex items-center gap-1 shadow-md"><Plus size={16}/> อุปกรณ์</button>
                            </div>
                        </div>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            {departmentList.map(dept => (
                                <div key={dept} onClick={() => { setSelectedDepartment(dept); setView('departmentItems'); }} className="bg-white p-4 rounded-xl shadow-sm border border-slate-100 hover:border-blue-400 cursor-pointer flex justify-between items-center">
                                    <div className="flex items-center gap-3">
                                        <div className="bg-blue-50 text-blue-600 p-2 rounded-lg"><Building2 size={20}/></div>
                                        <span className="font-medium">{dept}</span>
                                    </div>
                                    <span className="text-xs bg-slate-100 px-2 py-1 rounded-full text-slate-500">{counts[dept] || 0}</span>
                                </div>
                            ))}
                            {departmentList.length === 0 && <div className="col-span-full text-center py-10 text-slate-400">ยังไม่มีข้อมูลแผนก</div>}
                        </div>
                    </div>
                );
            };

            const DepartmentItemsView = () => {
                const filtered = items.filter(i => i.location === selectedDepartment && (i.name.toLowerCase().includes(searchTerm) || i.id.toLowerCase().includes(searchTerm)));
                return (
                    <div className="fade-in pb-10">
                        <div className="flex items-center gap-2 mb-4">
                            <button onClick={() => setView('departments')} className="p-2 hover:bg-slate-100 rounded-full"><ChevronLeft/></button>
                            <h2 className="text-xl font-bold">{selectedDepartment}</h2>
                        </div>
                        <div className="relative mb-4">
                            <input type="text" placeholder="ค้นหา..." className="w-full pl-9 pr-4 py-2 bg-white border rounded-lg shadow-sm" onChange={e => setSearchTerm(e.target.value)} />
                            <Search className="absolute left-3 top-2.5 text-slate-400" size={16}/>
                        </div>
                        <div className="space-y-3">
                            {filtered.map(item => (
                                <div key={item.id} onClick={() => { setSelectedItem(item); setView('detail'); }} className="bg-white p-3 rounded-xl shadow-sm border border-slate-100 flex gap-3 cursor-pointer hover:shadow-md">
                                    <div className="w-16 h-16 bg-slate-100 rounded-lg flex-shrink-0 overflow-hidden">
                                        {item.image ? <img src={item.image} className="w-full h-full object-cover"/> : <div className="w-full h-full flex items-center justify-center text-slate-300"><ImageIcon/></div>}
                                    </div>
                                    <div className="flex-1 min-w-0">
                                        <div className="flex justify-between"><h3 className="font-bold truncate">{item.name}</h3><span className={`text-[10px] px-2 py-0.5 rounded-full ${item.status==='active'?'bg-green-100 text-green-700':'bg-red-100 text-red-700'}`}>{item.status==='active'?'ปกติ':'ซ่อม'}</span></div>
                                        <div className="text-xs text-slate-500 font-mono">{item.id}</div>
                                        <div className="flex items-center gap-2 mt-1 text-xs text-slate-400">
                                            <span>{calculateAge(item.purchaseDate)}</span>
                                            {item.receiptPdf && <FileIcon size={12} className="text-orange-500"/>}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            // ... (AddView & DetailView similar logic to previous, ensuring handleAddItem/Update calls main actions) ...
            const AddView = () => {
                const [form, setForm] = useState({ id: generateCode(), name: '', location: selectedDepartment || '', purchaseDate: new Date().toISOString().split('T')[0], status: 'active', history: [] });
                const handleFile = async (e, k) => { if(e.target.files[0]) setForm({...form, [k]: await fileToBase64(e.target.files[0])}) };
                return (
                    <div className="fade-in max-w-lg mx-auto pb-10">
                        <button onClick={() => setView('departments')} className="mb-4 flex items-center gap-1 text-slate-500"><ChevronLeft size={18}/> ยกเลิก</button>
                        <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                            <h2 className="text-lg font-bold mb-4">เพิ่มอุปกรณ์</h2>
                            <form onSubmit={e => { e.preventDefault(); handleAddItem(form); }} className="space-y-3">
                                <div className="w-full h-32 bg-slate-50 border-2 border-dashed rounded-lg flex items-center justify-center relative overflow-hidden">
                                    {form.image ? <img src={form.image} className="w-full h-full object-cover"/> : <div className="text-center text-slate-400"><Camera className="mx-auto"/><span className="text-xs">เพิ่มรูป</span></div>}
                                    <input type="file" onChange={e => handleFile(e, 'image')} className="absolute inset-0 opacity-0 cursor-pointer" accept="image/*"/>
                                </div>
                                <input className="w-full p-2 border rounded" placeholder="ชื่ออุปกรณ์" required onChange={e => setForm({...form, name: e.target.value})}/>
                                <input className="w-full p-2 border rounded" placeholder="รุ่น / Model" onChange={e => setForm({...form, model: e.target.value})}/>
                                <div className="grid grid-cols-2 gap-3">
                                    <input type="date" className="p-2 border rounded" value={form.purchaseDate} onChange={e => setForm({...form, purchaseDate: e.target.value})}/>
                                    <input className="p-2 border rounded" placeholder="แผนก" list="depts" value={form.location} onChange={e => setForm({...form, location: e.target.value})}/>
                                    <datalist id="depts">{departmentList.map(d=><option key={d} value={d}/>)}</datalist>
                                </div>
                                <div className="bg-orange-50 p-3 rounded border border-orange-100 text-xs">
                                    <label className="flex items-center gap-2 text-orange-700 font-medium mb-1"><FileIcon size={14}/> ใบเสร็จ (PDF)</label>
                                    <input type="file" accept="application/pdf" onChange={e => handleFile(e, 'receiptPdf')} className="block w-full text-slate-500"/>
                                </div>
                                <button type="submit" disabled={isSyncing} className="w-full bg-blue-600 text-white py-3 rounded-lg font-bold shadow hover:bg-blue-700 disabled:bg-slate-300">
                                    {isSyncing ? 'กำลังบันทึก...' : 'บันทึก'}
                                </button>
                            </form>
                        </div>
                    </div>
                );
            };

            const DetailView = () => {
                const item = selectedItem;
                const [tab, setTab] = useState('info'); // info, history
                const [log, setLog] = useState({ id: Date.now(), date: new Date().toISOString().split('T')[0], type: 'repair', description: '', laborCost: 0, parts: [] });
                const [part, setPart] = useState({ name: '', price: 0 });

                const saveLog = () => {
                    const newEntry = { ...log, totalCost: Number(log.laborCost) + log.parts.reduce((s,p)=>s+Number(p.price),0) };
                    const updatedHistory = [newEntry, ...(item.history || [])];
                    handleUpdateItem({ ...item, history: updatedHistory });
                    setTab('info');
                    alert("บันทึกประวัติและกำลัง Sync...");
                };

                return (
                    <div className="fade-in max-w-2xl mx-auto pb-10">
                        <button onClick={() => setView('departmentItems')} className="mb-4 flex items-center gap-1 text-slate-500"><ChevronLeft size={18}/> กลับ</button>
                        
                        <div className="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden mb-4">
                            <div className="h-48 bg-slate-100 relative">
                                {item.image ? <img src={item.image} className="w-full h-full object-cover"/> : <div className="flex items-center justify-center h-full text-slate-300"><ImageIcon size={48}/></div>}
                                <div className="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/60 to-transparent p-4 pt-10">
                                    <h1 className="text-xl font-bold text-white">{item.name}</h1>
                                    <p className="text-white/80 text-sm">{item.id}</p>
                                </div>
                            </div>
                            
                            <div className="flex border-b">
                                <button onClick={() => setTab('info')} className={`flex-1 py-3 text-sm font-medium ${tab==='info'?'text-blue-600 border-b-2 border-blue-600':'text-slate-500'}`}>รายละเอียด</button>
                                <button onClick={() => setTab('history')} className={`flex-1 py-3 text-sm font-medium ${tab==='history'?'text-blue-600 border-b-2 border-blue-600':'text-slate-500'}`}>ประวัติซ่อม</button>
                            </div>

                            <div className="p-4">
                                {tab === 'info' && (
                                    <div className="space-y-4">
                                        <div className="grid grid-cols-2 gap-4 text-sm">
                                            <div><div className="text-slate-500">รุ่น</div><div>{item.model || '-'}</div></div>
                                            <div><div className="text-slate-500">วันที่ซื้อ</div><div>{item.purchaseDate}</div></div>
                                            <div><div className="text-slate-500">สถานะ</div><div className={item.status==='active'?'text-green-600':'text-red-600'}>{item.status}</div></div>
                                            <div><div className="text-slate-500">สถานที่</div><div>{item.location}</div></div>
                                        </div>
                                        {item.receiptPdf && (
                                            <a href={item.receiptPdf} target="_blank" className="flex items-center gap-2 bg-orange-50 text-orange-700 p-3 rounded-lg border border-orange-100 text-sm hover:bg-orange-100">
                                                <FileIcon size={16}/> เปิดดูใบเสร็จ (PDF)
                                            </a>
                                        )}
                                        <button onClick={() => deleteItem(item.id)} className="w-full border border-red-200 text-red-500 py-2 rounded-lg text-sm mt-4 hover:bg-red-50">ลบอุปกรณ์ (ซ่อน)</button>
                                    </div>
                                )}

                                {tab === 'history' && (
                                    <div>
                                        <div className="mb-6 border-b pb-6">
                                            <h3 className="font-bold text-sm mb-3 text-slate-800">+ เพิ่มรายการซ่อม</h3>
                                            <div className="space-y-3">
                                                <div className="grid grid-cols-2 gap-2">
                                                    <input type="date" className="border p-2 rounded text-sm" value={log.date} onChange={e=>setLog({...log, date:e.target.value})}/>
                                                    <select className="border p-2 rounded text-sm" onChange={e=>setLog({...log, type:e.target.value})}>
                                                        <option value="repair">ซ่อมแซม</option><option value="maintenance">บำรุงรักษา</option>
                                                    </select>
                                                </div>
                                                <textarea className="border p-2 rounded text-sm w-full" placeholder="รายละเอียดอาการ..." rows="2" onChange={e=>setLog({...log, description:e.target.value})}></textarea>
                                                
                                                <div className="bg-slate-50 p-2 rounded border">
                                                    <div className="flex gap-2 mb-2">
                                                        <input className="border p-1 rounded text-sm flex-1" placeholder="ชื่ออะไหล่" value={part.name} onChange={e=>setPart({...part, name:e.target.value})}/>
                                                        <input className="border p-1 rounded text-sm w-20" type="number" placeholder="บาท" value={part.price} onChange={e=>setPart({...part, price:e.target.value})}/>
                                                        <button onClick={()=>{ if(part.name) { setLog({...log, parts:[...log.parts, part]}); setPart({name:'', price:0}); }}} className="bg-slate-200 px-3 rounded">+</button>
                                                    </div>
                                                    {log.parts.map((p,i)=><div key={i} className="text-xs flex justify-between px-1">{p.name} <span>{p.price}</span></div>)}
                                                </div>

                                                <div className="flex items-center gap-2">
                                                    <span className="text-sm">ค่าแรง:</span>
                                                    <input type="number" className="border p-1 rounded w-24 text-sm" onChange={e=>setLog({...log, laborCost:e.target.value})}/>
                                                </div>
                                                <button onClick={saveLog} disabled={isSyncing} className="w-full bg-blue-600 text-white py-2 rounded-lg text-sm font-bold shadow">{isSyncing?'กำลังบันทึก...':'บันทึกประวัติ'}</button>
                                            </div>
                                        </div>
                                        
                                        <div className="space-y-4">
                                            {item.history && item.history.map((h, i) => (
                                                <div key={i} className="flex gap-3 text-sm">
                                                    <div className="flex flex-col items-center">
                                                        <div className="w-2 h-2 rounded-full bg-blue-500 mt-1.5"></div>
                                                        <div className="w-0.5 bg-slate-200 flex-1 my-1"></div>
                                                    </div>
                                                    <div className="flex-1 pb-4">
                                                        <div className="flex justify-between">
                                                            <span className="font-bold text-slate-700">{h.description}</span>
                                                            <span className="font-mono text-blue-600">฿{h.totalCost}</span>
                                                        </div>
                                                        <div className="text-xs text-slate-400">{h.date} • {h.type}</div>
                                                        {h.parts && h.parts.length > 0 && (
                                                            <div className="mt-1 bg-slate-50 p-2 rounded text-xs text-slate-500">
                                                                เปลี่ยนอะไหล่: {h.parts.map(p=>p.name).join(', ')}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            const AdminModal = () => (
                showAdminModal ? (
                <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                    <div className="bg-white p-6 rounded-xl w-full max-w-sm">
                        <h3 className="font-bold mb-4">ตั้งค่า URL</h3>
                        {showAdminModal === 'login' ? (
                            <form onSubmit={e => { e.preventDefault(); if(adminInputPassword===config.adminPassword) setShowAdminModal('settings'); else alert('ผิด'); }}>
                                <input type="password" autoFocus className="border w-full p-2 rounded mb-2" placeholder="รหัสผ่าน (888)" onChange={e=>setAdminInputPassword(e.target.value)}/>
                                <button className="bg-slate-800 text-white w-full py-2 rounded">เข้าสู่ระบบ</button>
                            </form>
                        ) : (
                            <div>
                                <input className="border w-full p-2 rounded mb-2 text-xs" value={tempConfig.scriptUrl} onChange={e=>setTempConfig({...tempConfig, scriptUrl:e.target.value})}/>
                                <button onClick={()=>{ setConfig(tempConfig); localStorage.setItem('assetTrackerConfig', JSON.stringify(tempConfig)); setShowAdminModal(false); alert('บันทึกแล้ว'); fetchFromGoogle(); }} className="bg-green-600 text-white w-full py-2 rounded mb-2">บันทึก</button>
                                <button onClick={()=>setShowAdminModal(false)} className="text-slate-400 w-full text-sm">ปิด</button>
                            </div>
                        )}
                    </div>
                </div>
                ) : null
            );

            return (
                <div className="min-h-screen bg-slate-50 font-sans text-slate-900 pb-20">
                    {isLoading && <LoadingOverlay/>}
                    <header className="bg-white border-b sticky top-0 z-10 px-4 h-14 flex items-center justify-between">
                        <div className="font-bold flex items-center gap-2"><FileText className="text-blue-600"/> Asset Cloud</div>
                        <div className="flex gap-2">
                             <button onClick={fetchFromGoogle} className="p-2 text-slate-500 hover:bg-slate-100 rounded-full" title="รีเฟรชข้อมูล"><RefreshCw size={20}/></button>
                             <button onClick={() => setShowAdminModal('login')} className="p-2 text-slate-500 hover:bg-slate-100 rounded-full"><Settings size={20}/></button>
                        </div>
                    </header>
                    <main className="max-w-5xl mx-auto px-4 pt-6">
                        {view === 'dashboard' && <DashboardView />}
                        {view === 'departments' && <DepartmentListView />}
                        {view === 'departmentItems' && <DepartmentItemsView />}
                        {view === 'add' && <AddView />}
                        {view === 'detail' && <DetailView />}
                    </main>
                    <AdminModal/>
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
